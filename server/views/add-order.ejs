<%- include('head'); %>
<body>
    <div class = "main">
        <div class = "overflow">
            <div class = "head">
                <a href = "/profile/" class = "hItem">клиент</a>
                <a href = "/order/" class = "active">закази</a>
                <a href = "/try-on/" class = "hItem">примерка</a>
                <a href = "./balance.html" class = "hItem">баланс клиента</a>
                <a href = "./entered-materials.html" class = "hItem">поступивший материал</a>
                <a href = "" class = "hItem">склад</a>
                <a href = "" class = "hItem">услуги</a>
                <a href = "" class = "hItem">расходы</a>
                <a href = "" class = "hItem">сост ... склад</a>
            </div>
            <div class = "title">
                <h1>создать заказ</h1>
            </div>
            <form class = "orderCont" action = "/order/add" method = "post">
                <% if(!notFill) { %>
                    <h2 class = "warning">заполните поля</h2>
                <% } %>
                <div class = "sectionCont">
                    <div class = "section">
                        <p>номер заказа</p>
                        <input disabled value = <%- numberOrder %> type = "number" name = "numberOrder" id = "numberOrder">
                        <p class = "<%- (order.dateOrder || notFill) ? '' : 'error' %>">дата заказа</p>
                            <input value = "<%- (order.dateOrder) ? order.dateOrder : '' %>" type = "date" name = "dateOrder" id = "date">
                        <p class = "<%- (order.typeOrder || notFill) ? '' : 'error' %>">тип заказа</p>
                        <select name = "typeOrder" id = "typeOrder">
                            <option value = ''>выбирайте тип заказа</option>
                            <% kindOrder.forEach((item, i) => { %>
                                <% if(order.typeOrder == item._id) { %>
                                    <option selected title = <%- item.price %> value = <%- item._id %>><%= item.name %></option>
                                <% } else { %>
                                    <option title = <%- item.price %> value = <%- item._id %>><%= item.name %></option>
                                <% } %>
                            <% }) %>
                        </select>
                        <p>материал заказчика</p>
                        <textarea value = "<%- (order.customerMaterial) ? order.customerMaterial : '' %>" name = "customerMaterial" id = "customerMaterial" cols="3" rows="5"></textarea>
                    </div>
                    <div class = "section">
                        <p class = "<%- (order.sumOrder || notFill) ? '' : 'error' %>">сумма заказа</p>
                        <input  value = "<%- (order.sumOrder) ? order.sumOrder : '' %>" onchange = "handleDebt()" type = "number" name = "sumOrder" id = "sumOrder">
                        <p class = "<%- (order.paid || notFill) ? '' : 'error' %>">оплачено</p>
                        <input   value = "<%- (order.paid) ? order.paid : '' %>" onchange = "handleDebt()" type = "number" name = "paid" id = "paid">
                        <p>долг</p>
                        <input   value = "<%- (order.debt) ? order.debt : '' %>" type = "number" name = "debt" id = "debt">
                        <p class = "<%- (order.customerStatus || notFill) ? '' : 'error' %>">статус клиента</p>
                        <select name = "customerStatus" id = "customerStatus">
                            <option value = ''>выбирайте статус клиента</option>
                            <% customerStatus.forEach((item) => { %>
                                <% if(order.customerStatus == item.value) { %>
                                    <option selected value = <%- item.value %>><%= item.name %></option>
                                <% } else { %>
                                    <option value = <%- item.value %>><%= item.name %></option>
                                <% } %>
                            <% }) %>
                        </select>
                        <p class = "<%- (order.executor || notFill) ? '' : 'error' %>">исполнитель</p>
                        <select name = "executor" id = "executor">
                            <option value = ''>выбирайте испольнителя</option>
                            <% employees.forEach((item) => { %>
                                <% if(order.executor == item._id) { %>
                                    <option selected value = <%- item._id %>><%= item.name %></option>
                                <% } else { %>
                                    <option value = <%- item._id %>><%= item.name %></option>
                                <% } %>
                                
                            <% }) %>
                        </select>
                        <p>ответственный</p>
                        <h2><%= responsible %></h2>
                    </div>
                    <div class = "section">
                        <p>заметки</p>
                        <textarea name = "notice" id = "notice" cols="25" rows="5"></textarea>
                        <p class = "<%- (order.client || notFill) ? '' : 'error' %>">клиент</p>
                        <select name = "client" id = "client">
                            <option value = ''>выбирайте клиента</option>
                            <% customer.forEach((item) => { %>
                                <% if(order.client == item._id) { %>
                                    <option selected value = <%- item._id %>><%= item.name %></option>
                                <% } else { %>
                                    <option value = <%- item._id %>><%= item.name %></option>
                                <% } %>
                            <% }) %>
                        </select>
                    </div>
                </div>
                <div class = "buttonCont">
                    <a class = "cancel cancelHover" href = "/order/">отмена</a>
                    <input class = "submit buttonHover" type = "submit" value = "добавить">
                </div>
            </form>
        </div>
    </div>
</body>
<script>
let typeOrder = document.getElementById('typeOrder')
let sumOrder = document.getElementById('sumOrder')
let paid = document.getElementById('paid')
let debt = document.getElementById('debt')
let form = document.getElementsByClassName('orderCont')
let template = document.getElementById('template')

const handleChange = ({target}) => {
    sumOrder.value = parseInt(target.selectedOptions[0].title)
}
console.log()
typeOrder.addEventListener('change', handleChange)

const handleDebt = () => debt.value = sumOrder.value - paid.value 

</script>
</html>